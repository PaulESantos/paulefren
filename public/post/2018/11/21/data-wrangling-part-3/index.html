<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>Data Wrangling Part 3 - Comandos básicos para la selección de observaciones  -  Paul Efren...</title>
    <meta property="og:title" content="Data Wrangling Part 3 -  Paul Efren...">
    
    <meta name="twitter:card" content="summary">

    
      
    

    
      
      <meta property="description" content="Esta es la tercera parte de la serie Data Wrangling.
[&amp;hellip;] library(tidyverse)La base de datos:Continuaremos trabajando con la información contenida en la base de datos msleep. Con la finalidad &amp;hellip;">
      <meta property="og:description" content="Esta es la tercera parte de la serie Data Wrangling.
[&amp;hellip;] library(tidyverse)La base de datos:Continuaremos trabajando con la información contenida en la base de datos msleep. Con la finalidad &amp;hellip;">
      
    

    
    

    

    
    


<link href='//cdn.bootcss.com/highlight.js/9.12.0/styles/github.min.css' rel='stylesheet' type='text/css' />



    <link rel="stylesheet" href="/css/style.css" />
    <link rel="stylesheet" href="/css/fonts.css" />
    <link rel="stylesheet" href="/css/custom.css" />

  </head>

  
  <body class="post">
    <header class="masthead">
      <h1><a href="/"> Paul Efren...</a></h1>

<p class="tagline">An space for R - DataScience for Biology...</p>

      <nav class="menu">
  <input id="menu-check" type="checkbox" />
  <label id="menu-label" for="menu-check" class="unselectable">
    <span class="icon close-icon">✕</span>
    <span class="icon open-icon">☰</span>
    <span class="text">Menu</span>
  </label>
  <ul>
  
  
  <li><a href="/">Home</a></li>
  
  <li><a href="/about/">About</a></li>
  
  <li><a href="/categories/">Categories</a></li>
  
  <li><a href="/tags/">Tags</a></li>
  
  
  </ul>
</nav>

    </header>

    <article class="main">
      <header class="title">
      
<h1>Data Wrangling Part 3</h1>
<h1><span class="subtitle">Comandos básicos para la selección de observaciones</span></h1>
<h3>Paul Efren Santos Andrade
  /  2018-11-21</h3>
<hr>


      </header>



<p>Esta es la tercera parte de la serie Data Wrangling.</p>
<div id="las-librerias" class="section level2">
<h2>Las librerias:</h2>
<pre class="r"><code>library(tidyverse)</code></pre>
</div>
<div id="la-base-de-datos" class="section level2">
<h2>La base de datos:</h2>
<p>Continuaremos trabajando con la información contenida en la base de datos <strong>msleep</strong>. Con la finalidad de facilitar la reproductibilidad del código usado en este tutorial.</p>
<pre class="r"><code>data(&quot;msleep&quot;)
glimpse(msleep)</code></pre>
<pre><code>## Observations: 83
## Variables: 11
## $ name         &lt;chr&gt; &quot;Cheetah&quot;, &quot;Owl monkey&quot;, &quot;Mountain beaver&quot;, &quot;Grea...
## $ genus        &lt;chr&gt; &quot;Acinonyx&quot;, &quot;Aotus&quot;, &quot;Aplodontia&quot;, &quot;Blarina&quot;, &quot;Bo...
## $ vore         &lt;chr&gt; &quot;carni&quot;, &quot;omni&quot;, &quot;herbi&quot;, &quot;omni&quot;, &quot;herbi&quot;, &quot;herbi...
## $ order        &lt;chr&gt; &quot;Carnivora&quot;, &quot;Primates&quot;, &quot;Rodentia&quot;, &quot;Soricomorph...
## $ conservation &lt;chr&gt; &quot;lc&quot;, NA, &quot;nt&quot;, &quot;lc&quot;, &quot;domesticated&quot;, NA, &quot;vu&quot;, N...
## $ sleep_total  &lt;dbl&gt; 12.1, 17.0, 14.4, 14.9, 4.0, 14.4, 8.7, 7.0, 10.1...
## $ sleep_rem    &lt;dbl&gt; NA, 1.8, 2.4, 2.3, 0.7, 2.2, 1.4, NA, 2.9, NA, 0....
## $ sleep_cycle  &lt;dbl&gt; NA, NA, NA, 0.1333333, 0.6666667, 0.7666667, 0.38...
## $ awake        &lt;dbl&gt; 11.9, 7.0, 9.6, 9.1, 20.0, 9.6, 15.3, 17.0, 13.9,...
## $ brainwt      &lt;dbl&gt; NA, 0.01550, NA, 0.00029, 0.42300, NA, NA, NA, 0....
## $ bodywt       &lt;dbl&gt; 50.000, 0.480, 1.350, 0.019, 600.000, 3.850, 20.4...</code></pre>
</div>
<div id="filter" class="section level2">
<h2><strong>filter()</strong></h2>
<p>En muchos de los casos no es necesario considerar todas las filas de nuestros <strong>data.frame</strong> y solo deseamos enfocarnos en un grupo de estas. La función que nos permite recuperar filas especificas es <strong>filter()</strong>.
El esquema general de esta función es:
<code>filter(data.frame, condición)</code></p>
<div id="seleccion-de-observaciones-incluidas-en-variables-numericas" class="section level3">
<h3><strong>Selección de observaciones incluidas en variables numéricas</strong></h3>
<p>Se puede seleccionar observaciones de variables numéricas con base en sus valores. Los operadores más usados para esta tarea son:<code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>==</code> y <code>!=</code>.</p>
<pre class="r"><code>msleep %&gt;% 
  select(name, sleep_total) %&gt;% 
  filter(sleep_total &gt; 18)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">sleep_total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Big brown bat</td>
<td align="right">19.7</td>
</tr>
<tr class="even">
<td align="left">Thick-tailed opposum</td>
<td align="right">19.4</td>
</tr>
<tr class="odd">
<td align="left">Little brown bat</td>
<td align="right">19.9</td>
</tr>
<tr class="even">
<td align="left">Giant armadillo</td>
<td align="right">18.1</td>
</tr>
</tbody>
</table>
<p>Si deseas recuperar un rango de valores, es posible usar dos condiciones lógicas. Por ejemplo, si se desea seleccionar todos los animales cuyo tiempo de sueño total varía entre 15 y 18 horas, <strong>filter(sleep_total&gt;=16, sleep_total &lt;=18)</strong>, una opción corta para cumplir con esta tarea es la función <strong>between()</strong>.</p>
<pre class="r"><code>msleep %&gt;% 
  select(name, sleep_total) %&gt;% 
  filter(between(sleep_total, 16, 18))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">sleep_total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Owl monkey</td>
<td align="right">17.0</td>
</tr>
<tr class="even">
<td align="left">Long-nosed armadillo</td>
<td align="right">17.4</td>
</tr>
<tr class="odd">
<td align="left">North American Opossum</td>
<td align="right">18.0</td>
</tr>
<tr class="even">
<td align="left">Arctic ground squirrel</td>
<td align="right">16.6</td>
</tr>
</tbody>
</table>
<p>Otra función útil es <strong>near()</strong>, esta permite recuperar todos los elementos cercanos a un valor determinado. Esta función requiere que se especifique un valor de tolerancia, el cual indicara los límites de la selección. Se puede utilizar un valor predeterminado como valor de tolerancia: <strong>filter(near(sleep_total, 17, tol = .5))</strong> esta recuperara todos los valores entre <strong>16.5</strong> y <strong>17.5</strong>, o un valor que sea resultado de una función.</p>
<p>El siguiente ejemplo recupera todas las filas cuyos valores varían entre 17 <strong>+/-</strong> la desviación estándar (<strong>sd()</strong>)de la variable tiempo total de sueño.</p>
<pre class="r"><code>msleep %&gt;% 
  select(name, sleep_total) %&gt;% 
  filter(near(sleep_total, 17, tol = sd(sleep_total)))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">sleep_total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Owl monkey</td>
<td align="right">17.0</td>
</tr>
<tr class="even">
<td align="left">Mountain beaver</td>
<td align="right">14.4</td>
</tr>
<tr class="odd">
<td align="left">Greater short-tailed shrew</td>
<td align="right">14.9</td>
</tr>
<tr class="even">
<td align="left">Three-toed sloth</td>
<td align="right">14.4</td>
</tr>
<tr class="odd">
<td align="left">Long-nosed armadillo</td>
<td align="right">17.4</td>
</tr>
<tr class="even">
<td align="left">North American Opossum</td>
<td align="right">18.0</td>
</tr>
</tbody>
</table>
</div>
<div id="seleccion-de-observaciones-en-variables-de-tipo-caracter" class="section level3">
<h3><strong>Selección de observaciones en variables de tipo carácter</strong></h3>
<p>Si deseas enfocarte en un grupo especio de animales, es necesario utilizar el operador <strong>==</strong>.</p>
<pre class="r"><code>msleep %&gt;% 
  select(order, name, sleep_total) %&gt;% 
  filter(order == &quot;Didelphimorphia&quot;)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">order</th>
<th align="left">name</th>
<th align="right">sleep_total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Didelphimorphia</td>
<td align="left">North American Opossum</td>
<td align="right">18.0</td>
</tr>
<tr class="even">
<td align="left">Didelphimorphia</td>
<td align="left">Thick-tailed opposum</td>
<td align="right">19.4</td>
</tr>
</tbody>
</table>
<p>Otros operadores usados:</p>
<p><strong>filter(order != “Rodentia”)</strong> selecciona todas las observaciones diferentes a <strong>Rodentia</strong>.</p>
<p><strong>filter(name &gt; “v”)</strong> selecciona las observaciones cuyos nombres(<code>name</code>) inician con las letras que seguin a la “v”.</p>
<p>Si deseas recuperar más de un elemento, el operador <strong>%in%</strong> permite realizar esta tarea. El siguiente ejemplo, selecciona las filas con información de animales pertenecientes a los órdenes <strong>Didelphimorphia</strong> y <strong>Diprotodontia</strong>.</p>
<pre class="r"><code>msleep %&gt;% 
  select(order, name, sleep_total) %&gt;% 
  filter(order %in% c(&quot;Didelphimorphia&quot;, &quot;Diprotodontia&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">order</th>
<th align="left">name</th>
<th align="right">sleep_total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Didelphimorphia</td>
<td align="left">North American Opossum</td>
<td align="right">18.0</td>
</tr>
<tr class="even">
<td align="left">Didelphimorphia</td>
<td align="left">Thick-tailed opposum</td>
<td align="right">19.4</td>
</tr>
<tr class="odd">
<td align="left">Diprotodontia</td>
<td align="left">Phalanger</td>
<td align="right">13.7</td>
</tr>
<tr class="even">
<td align="left">Diprotodontia</td>
<td align="left">Potoroo</td>
<td align="right">11.1</td>
</tr>
</tbody>
</table>
<p>También puedes usar el operador <strong>%in%</strong> para ignorar ciertos grupos. Para cumplir esta tarea se deberá agregar el operador <strong>!</strong> negación como primer argumento de la función <strong>filter()</strong>.</p>
<pre class="r"><code>remove &lt;- c(&quot;Rodentia&quot;, &quot;Carnivora&quot;, &quot;Primates&quot;)

msleep %&gt;% 
  select(order, name, sleep_total) %&gt;% 
  filter(!order %in% remove)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">order</th>
<th align="left">name</th>
<th align="right">sleep_total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Soricomorpha</td>
<td align="left">Greater short-tailed shrew</td>
<td align="right">14.9</td>
</tr>
<tr class="even">
<td align="left">Artiodactyla</td>
<td align="left">Cow</td>
<td align="right">4.0</td>
</tr>
<tr class="odd">
<td align="left">Pilosa</td>
<td align="left">Three-toed sloth</td>
<td align="right">14.4</td>
</tr>
<tr class="even">
<td align="left">Artiodactyla</td>
<td align="left">Roe deer</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td align="left">Artiodactyla</td>
<td align="left">Goat</td>
<td align="right">5.3</td>
</tr>
<tr class="even">
<td align="left">Soricomorpha</td>
<td align="left">Star-nosed mole</td>
<td align="right">10.3</td>
</tr>
</tbody>
</table>
</div>
<div id="seleccion-de-observaciones-con-base-en-multiples-condiciones" class="section level3">
<h3><strong>Selección de observaciones con base en múltiples condiciones</strong></h3>
<p>Los ejemplos anteriores seleccionan las filas con base en una sola condición, pero <strong>filter()</strong> permite otros tipos de condiciónales:</p>
<ul>
<li><p><code>filter(condición1, condición2)</code> devolverá como resultado las filas que cumplan ambas condiciones.</p></li>
<li><p><code>filter(condición1, !condición2)</code> obtendrá como resulta las filas para las cuales se cumple la condición uno mas no la condición dos.</p></li>
<li><p><code>filter(condición1 | condición2)</code> retornara las filas que cumplan las dos condiciones.</p></li>
<li><p><code>filter(xor(condición1, condición2)</code> obtendrá como resultado las filas en las que cumplan solo una de las condiciones.</p></li>
</ul>
<p>Múltiples condiciónales pueden ser combinados <strong>y</strong>, <strong>o</strong> y <strong>no</strong>. El ejemplo selecciona todas las filas en las cuales la variable <strong>bodywt</strong> es mayor a <strong>100</strong> y con un valor de la variable <strong>sleep_total</strong> mayor a <strong>15</strong> que no pertenezcan al orden <strong>Carnívora</strong>.</p>
<pre class="r"><code>msleep %&gt;%
  select(name, order, sleep_total:bodywt) %&gt;%
  filter(bodywt &gt; 100,
         (sleep_total &gt; 15 | order != &quot;Carnivora&quot;))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">order</th>
<th align="right">sleep_total</th>
<th align="right">sleep_rem</th>
<th align="right">sleep_cycle</th>
<th align="right">awake</th>
<th align="right">brainwt</th>
<th align="right">bodywt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Cow</td>
<td align="left">Artiodactyla</td>
<td align="right">4.0</td>
<td align="right">0.7</td>
<td align="right">0.6666667</td>
<td align="right">20.00</td>
<td align="right">0.423</td>
<td align="right">600.000</td>
</tr>
<tr class="even">
<td align="left">Asian elephant</td>
<td align="left">Proboscidea</td>
<td align="right">3.9</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">20.10</td>
<td align="right">4.603</td>
<td align="right">2547.000</td>
</tr>
<tr class="odd">
<td align="left">Horse</td>
<td align="left">Perissodactyla</td>
<td align="right">2.9</td>
<td align="right">0.6</td>
<td align="right">1.0000000</td>
<td align="right">21.10</td>
<td align="right">0.655</td>
<td align="right">521.000</td>
</tr>
<tr class="even">
<td align="left">Donkey</td>
<td align="left">Perissodactyla</td>
<td align="right">3.1</td>
<td align="right">0.4</td>
<td align="right">NA</td>
<td align="right">20.90</td>
<td align="right">0.419</td>
<td align="right">187.000</td>
</tr>
<tr class="odd">
<td align="left">Giraffe</td>
<td align="left">Artiodactyla</td>
<td align="right">1.9</td>
<td align="right">0.4</td>
<td align="right">NA</td>
<td align="right">22.10</td>
<td align="right">NA</td>
<td align="right">899.995</td>
</tr>
<tr class="even">
<td align="left">Pilot whale</td>
<td align="left">Cetacea</td>
<td align="right">2.7</td>
<td align="right">0.1</td>
<td align="right">NA</td>
<td align="right">21.35</td>
<td align="right">NA</td>
<td align="right">800.000</td>
</tr>
<tr class="odd">
<td align="left">African elephant</td>
<td align="left">Proboscidea</td>
<td align="right">3.3</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">20.70</td>
<td align="right">5.712</td>
<td align="right">6654.000</td>
</tr>
<tr class="even">
<td align="left">Tiger</td>
<td align="left">Carnivora</td>
<td align="right">15.8</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">8.20</td>
<td align="right">NA</td>
<td align="right">162.564</td>
</tr>
<tr class="odd">
<td align="left">Brazilian tapir</td>
<td align="left">Perissodactyla</td>
<td align="right">4.4</td>
<td align="right">1.0</td>
<td align="right">0.9000000</td>
<td align="right">19.60</td>
<td align="right">0.169</td>
<td align="right">207.501</td>
</tr>
<tr class="even">
<td align="left">Bottle-nosed dolphin</td>
<td align="left">Cetacea</td>
<td align="right">5.2</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">18.80</td>
<td align="right">NA</td>
<td align="right">173.330</td>
</tr>
</tbody>
</table>
<p><strong>xor()</strong></p>
<pre class="r"><code>msleep %&gt;%
  select(name, bodywt:brainwt) %&gt;% 
  filter(xor(bodywt &gt; 100, brainwt &gt; 1))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">bodywt</th>
<th align="right">brainwt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Cow</td>
<td align="right">600.000</td>
<td align="right">0.423</td>
</tr>
<tr class="even">
<td align="left">Horse</td>
<td align="right">521.000</td>
<td align="right">0.655</td>
</tr>
<tr class="odd">
<td align="left">Donkey</td>
<td align="right">187.000</td>
<td align="right">0.419</td>
</tr>
<tr class="even">
<td align="left">Human</td>
<td align="right">62.000</td>
<td align="right">1.320</td>
</tr>
<tr class="odd">
<td align="left">Brazilian tapir</td>
<td align="right">207.501</td>
<td align="right">0.169</td>
</tr>
</tbody>
</table>
<p><strong>El operador negación(!):</strong></p>
<p>El siguiente ejemplo devuelve las filas en las cuales la variable <strong>brainwt</strong> es mayor a 1, pero las variable <strong>bodywt</strong> no sea mayor a <strong>100</strong>.</p>
<pre class="r"><code>msleep %&gt;% 
  select(name, sleep_total, brainwt, bodywt) %&gt;% 
  filter(brainwt &gt; 1, !bodywt &gt; 100)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">sleep_total</th>
<th align="right">brainwt</th>
<th align="right">bodywt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Human</td>
<td align="right">8</td>
<td align="right">1.32</td>
<td align="right">62</td>
</tr>
</tbody>
</table>
</div>
<div id="filtrando-las-filas-cuyas-observaciones-no-contienen-informacion-na" class="section level3">
<h3><strong>Filtrando las filas cuyas observaciones no contienen información (<em>NA</em>)</strong></h3>
<p>Si buscamos ignorar las filas que no contienen información es necesario combinar: el operador <strong>!</strong> y la función <strong>is.na()</strong>, para usarlo como un argumento de la función <strong>filter()</strong>.</p>
<p>El siguiente ejemplo retira todas las filas de la variable <strong>conservation</strong> cuyo valor es <strong>NA</strong>.</p>
<pre class="r"><code>msleep %&gt;% 
  select(name, conservation:sleep_cycle) %&gt;% 
  filter(!is.na(conservation))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">conservation</th>
<th align="right">sleep_total</th>
<th align="right">sleep_rem</th>
<th align="right">sleep_cycle</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Cheetah</td>
<td align="left">lc</td>
<td align="right">12.1</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Mountain beaver</td>
<td align="left">nt</td>
<td align="right">14.4</td>
<td align="right">2.4</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">Greater short-tailed shrew</td>
<td align="left">lc</td>
<td align="right">14.9</td>
<td align="right">2.3</td>
<td align="right">0.1333333</td>
</tr>
<tr class="even">
<td align="left">Cow</td>
<td align="left">domesticated</td>
<td align="right">4.0</td>
<td align="right">0.7</td>
<td align="right">0.6666667</td>
</tr>
<tr class="odd">
<td align="left">Northern fur seal</td>
<td align="left">vu</td>
<td align="right">8.7</td>
<td align="right">1.4</td>
<td align="right">0.3833333</td>
</tr>
<tr class="even">
<td align="left">Dog</td>
<td align="left">domesticated</td>
<td align="right">10.1</td>
<td align="right">2.9</td>
<td align="right">0.3333333</td>
</tr>
</tbody>
</table>
</div>
<div id="filtros-en-multiples-columnas" class="section level3">
<h3><strong>Filtros en múltiples columnas</strong></h3>
<p><strong>dplyr</strong> ofrece una serie de variantes de la función <strong>filter()</strong> que actúan sobre múltiples columnas:</p>
<ul>
<li><code>Filter_all</code> actúa sobre todas las columnas.</li>
<li><code>Filter_if</code> y <code>filter_at</code> actúa sobre un grupo específico de columnas.</li>
</ul>
<p>Estas opciones tienen una formula general básica: primero es necesario especificar las columnas con las cuales se trabajara, seguida de la condición utilizada como filtro. En muchos casos será necesario el operador <strong>.</strong> como parte de la condición para hacer referencia los valores que estamos buscando.</p>
</div>
<div id="filter_all" class="section level3">
<h3><strong>filter_all()</strong></h3>
<p>El ejemplo selecciona todas las filas que contengan los caracteres <strong>Ca</strong> en los valores de cualquiera de las columnas.</p>
<pre class="r"><code>msleep %&gt;% 
  select(name:order, sleep_total, -vore) %&gt;% 
  filter_all(any_vars(str_detect(., pattern = &quot;Ca&quot;)))</code></pre>
<pre><code>## # A tibble: 16 x 4
##    name              genus        order        sleep_total
##    &lt;chr&gt;             &lt;chr&gt;        &lt;chr&gt;              &lt;dbl&gt;
##  1 Cheetah           Acinonyx     Carnivora           12.1
##  2 Northern fur seal Callorhinus  Carnivora            8.7
##  3 Vesper mouse      Calomys      Rodentia             7  
##  4 Dog               Canis        Carnivora           10.1
##  5 Roe deer          Capreolus    Artiodactyla         3  
##  6 Goat              Capri        Artiodactyla         5.3
##  7 Guinea pig        Cavis        Rodentia             9.4
##  8 Domestic cat      Felis        Carnivora           12.5
##  9 Gray seal         Haliochoerus Carnivora            6.2
## 10 Tiger             Panthera     Carnivora           15.8
## 11 Jaguar            Panthera     Carnivora           10.4
## 12 Lion              Panthera     Carnivora           13.5
## 13 Caspian seal      Phoca        Carnivora            3.5
## 14 Genet             Genetta      Carnivora            6.3
## 15 Arctic fox        Vulpes       Carnivora           12.5
## 16 Red fox           Vulpes       Carnivora            9.8</code></pre>
<p>El siguiente código selecciona todas las filas que contengan valores menores a <strong>0.1</strong>:</p>
<pre class="r"><code>msleep %&gt;%  
  select(name, sleep_total:bodywt) %&gt;% 
  filter_all(any_vars(. &lt; 0.1))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">sleep_total</th>
<th align="right">sleep_rem</th>
<th align="right">sleep_cycle</th>
<th align="right">awake</th>
<th align="right">brainwt</th>
<th align="right">bodywt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Owl monkey</td>
<td align="right">17.0</td>
<td align="right">1.8</td>
<td align="right">NA</td>
<td align="right">7.0</td>
<td align="right">0.01550</td>
<td align="right">0.480</td>
</tr>
<tr class="even">
<td align="left">Greater short-tailed shrew</td>
<td align="right">14.9</td>
<td align="right">2.3</td>
<td align="right">0.1333333</td>
<td align="right">9.1</td>
<td align="right">0.00029</td>
<td align="right">0.019</td>
</tr>
<tr class="odd">
<td align="left">Vesper mouse</td>
<td align="right">7.0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">17.0</td>
<td align="right">NA</td>
<td align="right">0.045</td>
</tr>
<tr class="even">
<td align="left">Dog</td>
<td align="right">10.1</td>
<td align="right">2.9</td>
<td align="right">0.3333333</td>
<td align="right">13.9</td>
<td align="right">0.07000</td>
<td align="right">14.000</td>
</tr>
<tr class="odd">
<td align="left">Roe deer</td>
<td align="right">3.0</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">21.0</td>
<td align="right">0.09820</td>
<td align="right">14.800</td>
</tr>
<tr class="even">
<td align="left">Guinea pig</td>
<td align="right">9.4</td>
<td align="right">0.8</td>
<td align="right">0.2166667</td>
<td align="right">14.6</td>
<td align="right">0.00550</td>
<td align="right">0.728</td>
</tr>
</tbody>
</table>
<p>El comando <strong>any_vars()</strong> es equivalente a al condicional <strong>o</strong>, así el comando <strong>all_vars()</strong> es equivalente al condicional <strong>y</strong>.</p>
<p>El siguiente ejemplo devuelve todas las filas en las cuales los valores de sus observaciones sean mayores a <strong>1</strong>.</p>
<pre class="r"><code>msleep %&gt;%  
  select(name, sleep_total:bodywt, -awake) %&gt;% 
  filter_all(all_vars(. &gt; 1))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">sleep_total</th>
<th align="right">sleep_rem</th>
<th align="right">sleep_cycle</th>
<th align="right">brainwt</th>
<th align="right">bodywt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Human</td>
<td align="right">8</td>
<td align="right">1.9</td>
<td align="right">1.5</td>
<td align="right">1.32</td>
<td align="right">62</td>
</tr>
</tbody>
</table>
</div>
<div id="filter_if" class="section level3">
<h3><strong>filter_if()</strong></h3>
<p>Nos permite especificar sobre qué tipo de variables se aplicara la fusión. El siguiente ejemplo actúa únicamente sobre las filas de las variables de tipo carácter que no contengan información (<strong>NA</strong>).</p>
<pre class="r"><code>msleep %&gt;% 
  select(name:order, sleep_total:sleep_rem) %&gt;% 
  filter_if(is.character, any_vars(is.na(.)))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="left">genus</th>
<th align="left">vore</th>
<th align="left">order</th>
<th align="right">sleep_total</th>
<th align="right">sleep_rem</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Vesper mouse</td>
<td align="left">Calomys</td>
<td align="left">NA</td>
<td align="left">Rodentia</td>
<td align="right">7.0</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Desert hedgehog</td>
<td align="left">Paraechinus</td>
<td align="left">NA</td>
<td align="left">Erinaceomorpha</td>
<td align="right">10.3</td>
<td align="right">2.7</td>
</tr>
<tr class="odd">
<td align="left">Deer mouse</td>
<td align="left">Peromyscus</td>
<td align="left">NA</td>
<td align="left">Rodentia</td>
<td align="right">11.5</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">Phalanger</td>
<td align="left">Phalanger</td>
<td align="left">NA</td>
<td align="left">Diprotodontia</td>
<td align="right">13.7</td>
<td align="right">1.8</td>
</tr>
<tr class="odd">
<td align="left">Rock hyrax</td>
<td align="left">Procavia</td>
<td align="left">NA</td>
<td align="left">Hyracoidea</td>
<td align="right">5.4</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td align="left">Mole rat</td>
<td align="left">Spalax</td>
<td align="left">NA</td>
<td align="left">Rodentia</td>
<td align="right">10.6</td>
<td align="right">2.4</td>
</tr>
<tr class="odd">
<td align="left">Musk shrew</td>
<td align="left">Suncus</td>
<td align="left">NA</td>
<td align="left">Soricomorpha</td>
<td align="right">12.8</td>
<td align="right">2.0</td>
</tr>
</tbody>
</table>
<p>De forma semejante es posible utilizar los siguientes funciones para especificar sobre qué tipo de variable actuara el filtro: <code>is.numeric</code>, <code>is.integer</code>, <code>is.double</code>, <code>is.logical</code>, <code>is.factor</code>, <code>is.POSIXt</code> o <code>is.Date</code>.</p>
</div>
<div id="filter_at" class="section level3">
<h3><strong>filter_at()</strong></h3>
<p>Una de las funciones más útiles es <strong>filter_at()</strong>: es necesario seleccionar las columnas sobre las cuales actuara el filtro mediante el argumento <strong>vars()</strong>. El siguiente argumento es la condición mediante la cual se filtraran las filas, es posible usar <code>all_vars()</code> si la condición es cumplida en todas las columnas, o <code>any_vars()</code> si solo una de las variables cumple con la condición.</p>
<p>Por ejemplo, el siguiente código actúa sobre las variables <strong>sleep_total</strong> y <strong>sleep_rem</strong>, seleccionando las filas si los valores de las observaciones de ambas variables son mayores a <strong>5</strong>.</p>
<pre class="r"><code>msleep %&gt;% 
  select(name, sleep_total:sleep_rem, brainwt:bodywt) %&gt;% 
  filter_at(vars(sleep_total, sleep_rem), all_vars(.&gt;5))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">sleep_total</th>
<th align="right">sleep_rem</th>
<th align="right">brainwt</th>
<th align="right">bodywt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Thick-tailed opposum</td>
<td align="right">19.4</td>
<td align="right">6.6</td>
<td align="right">NA</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="left">Giant armadillo</td>
<td align="right">18.1</td>
<td align="right">6.1</td>
<td align="right">0.081</td>
<td align="right">60.00</td>
</tr>
</tbody>
</table>
<p>Otra forma de seleccionar las variables sobre las cuales actuara el filtro:</p>
<pre class="r"><code>msleep %&gt;% 
  select(name, sleep_total:sleep_rem, brainwt:bodywt) %&gt;% 
  filter_at(vars(contains(&quot;sleep&quot;)), all_vars(.&gt;5))</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">name</th>
<th align="right">sleep_total</th>
<th align="right">sleep_rem</th>
<th align="right">brainwt</th>
<th align="right">bodywt</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Thick-tailed opposum</td>
<td align="right">19.4</td>
<td align="right">6.6</td>
<td align="right">NA</td>
<td align="right">0.37</td>
</tr>
<tr class="even">
<td align="left">Giant armadillo</td>
<td align="right">18.1</td>
<td align="right">6.1</td>
<td align="right">0.081</td>
<td align="right">60.00</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="referencias" class="section level2">
<h2>Referencias:</h2>
<ol style="list-style-type: decimal">
<li>Basado en el tutorial de <a href="https://suzan.rbind.io/2018/02/dplyr-tutorial-3/">Suzan Baert</a>: <strong>Data Wrangling Part 3: Basic and more advanced ways to filter rows</strong></li>
</ol>
</div>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev">&larr; <a href="/post/2018/11/12/data-wrangling-part-1/">Data Wrangling Part 1</a></span>
  <span class="nav-next"><a href="/post/2018/11/26/data-wrangling-part-4/">Data Wrangling Part 4</a> &rarr;</span>
</nav>



<section class="comments">
  <div id="disqus_thread"></div>
  <script>
  var disqus_config = function () {
  
  };
  (function() {
    var inIFrame = function() {
      var iframe = true;
      try { iframe = window.self !== window.top; } catch (e) {}
      return iframe;
    };
    if (inIFrame()) return;
    var disqus_js = '//Paul Efren notes....disqus.com/embed.js';
    var d = document, s = d.createElement('script');
    s.src = disqus_js; s.async = true;
    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
  })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</section>



<script src="//yihui.name/js/math-code.js"></script>
<script async src="//cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML"></script>

<script async src="//yihui.name/js/center-img.js"></script>

  



<script src="//cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>



<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/r.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/yaml.min.js"></script>
<script src="//cdn.bootcss.com/highlight.js/9.12.0/languages/tex.min.js"></script>
<script>hljs.configure({languages: []}); hljs.initHighlightingOnLoad();</script>



  
  <hr>
  <div class="copyright">&copy; PaulESA 2018 | <a href="https://github.com/PaulESantos">Github</a> | <a href="https://twitter.com/PaulEfrenSantos">Twitter</a> |Powered by the <a href="https://ivy.yihui.name/">Ivy theme</a> for <a href="https://gohugo.io/">Hugo</a></div>
  
  </footer>
  </article>
  
  </body>
</html>

