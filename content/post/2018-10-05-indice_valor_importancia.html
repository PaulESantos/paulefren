---
title: "Índice Valor Importancia"
author: "Paul Efren Santos Andrade"
date: 2018-10-05
categories: ["R"]
tags: ["Dataviz", "Plant diversity", "Data management"]
---



<div id="los-paquetes-en-r" class="section level2">
<h2>Los paquetes en R:</h2>
<ul>
<li><em>tidyverse</em> proporciona herramientas para el manejo y análisis de datos, se compone de múltiples paquetes que tienen una gramática común.</li>
</ul>
<pre class="r"><code>#install.packages(&quot;tidyverse&quot;)
#install.packages(&quot;knitr&quot;)
library(tidyverse)
library(knitr)</code></pre>
</div>
<div id="la-base-de-datos" class="section level2">
<h2>La base de datos:</h2>
<p>Para este ejemplo modificamos la información de la base de datos <strong>BCI</strong> del paquete <code>vegan</code>.</p>
<table>
<thead>
<tr class="header">
<th align="left">Parcela</th>
<th align="left">Especie</th>
<th align="right">DAP</th>
<th align="right">Area basal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alchornea.costaricensis</td>
<td align="right">15.93544</td>
<td align="right">454.8143</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alchornea.costaricensis</td>
<td align="right">10.58561</td>
<td align="right">1994.3443</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">46.93351</td>
<td align="right">1552.6553</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">58.68267</td>
<td align="right">1022.7831</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">53.60771</td>
<td align="right">2009.3311</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">55.29882</td>
<td align="right">1650.4052</td>
</tr>
</tbody>
</table>
<p>Estos datos fueron generados aleatoriamente para este ejemplo, no corresponden a ningún inventario real. Se toma como modelo la información colectada en una parcela de 1ha; dividida en 25 sub parcelas, en las cuales se tiene el registro de cada uno de los individuos encontrados en esta e identificados a nivel de especie.</p>
</div>
<div id="conociendo-nuestros-datos" class="section level2">
<h2>Conociendo nuestros datos:</h2>
<p>Una vez que tenemos los datos en R es necesario revisar algunas características básicas de estos; el comando <em>dim()</em>, nos permite conocer el número de observaciones y variables que contiene el <em>dataframe</em>.</p>
<pre class="r"><code>dim(data)
## [1] 21457     4</code></pre>
<p>El comando <em>head()</em> nos permitirá revisar la información contenida en las primeras seis filas de nuestra base de datos.</p>
<pre class="r"><code>head(data)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">parcela</th>
<th align="left">especies</th>
<th align="right">dap</th>
<th align="right">a_basal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alchornea.costaricensis</td>
<td align="right">15.93544</td>
<td align="right">454.8143</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alchornea.costaricensis</td>
<td align="right">10.58561</td>
<td align="right">1994.3443</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">46.93351</td>
<td align="right">1552.6553</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">58.68267</td>
<td align="right">1022.7831</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">53.60771</td>
<td align="right">2009.3311</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">55.29882</td>
<td align="right">1650.4052</td>
</tr>
</tbody>
</table>
<p>Mientras el comando <em>tail()</em> nos permitirá evaluar la información contenida en las últimas seis filas del dataframe.</p>
<pre class="r"><code>tail(data)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">parcela</th>
<th align="left">especies</th>
<th align="right">dap</th>
<th align="right">a_basal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">9</td>
<td align="left">Zanthoxylum.ekmanii</td>
<td align="right">41.47843</td>
<td align="right">2392.284</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">Zanthoxylum.juniperinum</td>
<td align="right">45.30176</td>
<td align="right">1379.318</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">Zanthoxylum.panamense</td>
<td align="right">54.39507</td>
<td align="right">1255.704</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">Zanthoxylum.panamense</td>
<td align="right">37.61913</td>
<td align="right">1532.037</td>
</tr>
<tr class="odd">
<td align="left">9</td>
<td align="left">Zanthoxylum.panamense</td>
<td align="right">35.18501</td>
<td align="right">2765.546</td>
</tr>
<tr class="even">
<td align="left">9</td>
<td align="left">Zanthoxylum.panamense</td>
<td align="right">11.59724</td>
<td align="right">1919.963</td>
</tr>
</tbody>
</table>
<p>Si buscamos conocer cuáles son las observaciones que corresponden a la sub parcela número 1 podemos hacerlo con el siguiente código:</p>
<pre class="r"><code>data[which(data$parcela == 1),]</code></pre>
<p>Podemos conseguir el mismo resultado con la función <em>filter()</em> del paquete <em>dplyr</em>:</p>
<pre class="r"><code>data %&gt;%
  filter(parcela == 1)</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">parcela</th>
<th align="left">especies</th>
<th align="right">dap</th>
<th align="right">a_basal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alchornea.costaricensis</td>
<td align="right">15.93544</td>
<td align="right">454.8143</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alchornea.costaricensis</td>
<td align="right">10.58561</td>
<td align="right">1994.3443</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">46.93351</td>
<td align="right">1552.6553</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">58.68267</td>
<td align="right">1022.7831</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">53.60771</td>
<td align="right">2009.3311</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">55.29882</td>
<td align="right">1650.4052</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">36.71813</td>
<td align="right">492.2388</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">47.22068</td>
<td align="right">1247.1045</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">31.01860</td>
<td align="right">1095.4845</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">16.20021</td>
<td align="right">746.6729</td>
</tr>
</tbody>
</table>
</div>
<div id="indice-de-valor-de-importancia" class="section level2">
<h2>Índice de valor de importancia:</h2>
<p>Las comunidades vegetales están compuestas por un grupo de especies, cada una con una abundancia diferente. Todas las especies compiten por acceder a recursos (agua, luz, CO2, etc.), las especies que mejor aprovechen estos recursos serán las que dominen la comunidad, determinando su estructura. La forma como estas aprovechen la energía del sistema nos permitirá conocer el comportamiento ecológico de la comunidad, esto se puede realizar mediante el cálculo de los valores de importancia de cada especie.</p>
<p>El índice de valor de inportancia (<code>IVI</code>) define como de las especies presentes en la comunidad contribuyen en el carácter y estructura de un ecosistema <a href="http://cescos.fau.edu/gawliklab/papers/CottamGandJTCurtis1956.pdf">(Cottam y Curtis,1956)</a>. Este valor se obtiene mediante la sumatoria de la frecuencia relativa, la densidad relativa y la dominancia relativa.</p>
<div id="densidad-y-frecuencia-absoluta" class="section level3">
<h3>Densidad y Frecuencia absoluta:</h3>
<ul>
<li>El primer paso para determinar el valor del IVI, es conocer el número de individuos por especie y el número de sub parcelas en las cuales está presente esta. Esto podemos obtenerlo mediante el siguiente código.</li>
</ul>
<pre class="r"><code>data %&gt;%
  group_by(especies) %&gt;% 
  summarise(
  n_individuos = n(),# número de individuos de la especie &quot;i&quot;.
  n_suplot = n_distinct(parcela),#número de sub parcelas en las que esta presente la especie.
  area_basal = sum(a_basal)# area basal total de la especie &quot;i&quot;.
  )</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Especie</th>
<th align="right">Indi. por especie</th>
<th align="right">Frecuencia</th>
<th align="right">Area basal</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Abarema.macradenia</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2674.957</td>
</tr>
<tr class="even">
<td align="left">Acalypha.diversifolia</td>
<td align="right">2</td>
<td align="right">2</td>
<td align="right">4211.375</td>
</tr>
<tr class="odd">
<td align="left">Acalypha.macrostachya</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">2181.220</td>
</tr>
<tr class="even">
<td align="left">Adelia.triloba</td>
<td align="right">92</td>
<td align="right">27</td>
<td align="right">144947.279</td>
</tr>
<tr class="odd">
<td align="left">Aegiphila.panamensis</td>
<td align="right">23</td>
<td align="right">18</td>
<td align="right">36648.507</td>
</tr>
<tr class="even">
<td align="left">Alchornea.costaricensis</td>
<td align="right">156</td>
<td align="right">44</td>
<td align="right">234851.556</td>
</tr>
</tbody>
</table>
</div>
<div id="densidad-frecuencia-y-dominancia-relativa" class="section level3">
<h3>Densidad, Frecuencia y Dominancia Relativa:</h3>
<div id="densidad-relativa-dr" class="section level4">
<h4>Densidad relativa: <code>DR</code></h4>
<ul>
<li>O abundancia relativa, es el número de individuos de una especie dividida entre el número total de individuos de la comunidad multiplicado por cien.</li>
</ul>
</div>
<div id="frecuencia-relativa-fr" class="section level4">
<h4>Frecuencia relativa: <code>FR</code></h4>
<p>Es la frecuencia (número de sub parcelas en las cuales ocurre la especie) dividida por la suma de las frecuencias de todas las especies, multiplicado por cien.</p>
</div>
<div id="dominancia-relativa-dmr" class="section level4">
<h4>Dominancia relativa: <code>DmR</code></h4>
<p>La dominancia se mide en función al área basal (es el área en m² que ocupa un corte transversal del tronco) de cada una de las especies, se calcula dividiendo el área basal de la especie por la sumatoria de las áreas basales de todas las especies presentes en la parcela, multiplicándola por cien.</p>
<ul>
<li><p>Finalmente el valor de importancia: <code>IVI</code></p>
<pre><code>               IVI = (DR + FR + DmR)/3</code></pre></li>
</ul>
<p>Las siguientes líneas nos permiten determinar cada uno de los valores antes mencionados. Para no desplegar toda la tabla solo se mostraran las diez especies con mayor valor de importancia.</p>
<pre class="r"><code>install.packages(&quot;devtools&quot;) 
devtools::install_github(&quot;PaulESantos/diversity.tool&quot;)
library(diversity.tool)

data %&gt;% 
  ivi_index()</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Especie</th>
<th align="right">DR</th>
<th align="right">FR</th>
<th align="right">DmR</th>
<th align="right">IVI</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Faramea.occidentalis</td>
<td align="right">8.002051</td>
<td align="right">1.101564</td>
<td align="right">7.894501</td>
<td align="right">5.666038</td>
</tr>
<tr class="even">
<td align="left">Trichilia.tuberculata</td>
<td align="right">7.834273</td>
<td align="right">1.101564</td>
<td align="right">7.832472</td>
<td align="right">5.589436</td>
</tr>
<tr class="odd">
<td align="left">Alseis.blackiana</td>
<td align="right">4.581256</td>
<td align="right">1.101564</td>
<td align="right">4.732643</td>
<td align="right">3.471821</td>
</tr>
<tr class="even">
<td align="left">Oenocarpus.mapora</td>
<td align="right">3.672461</td>
<td align="right">1.101564</td>
<td align="right">3.615729</td>
<td align="right">2.796585</td>
</tr>
<tr class="odd">
<td align="left">Poulsenia.armata</td>
<td align="right">3.518665</td>
<td align="right">1.013439</td>
<td align="right">3.430927</td>
<td align="right">2.654344</td>
</tr>
<tr class="even">
<td align="left">Quararibea.asterolepis</td>
<td align="right">3.374190</td>
<td align="right">1.079533</td>
<td align="right">3.402036</td>
<td align="right">2.618586</td>
</tr>
<tr class="odd">
<td align="left">Hirtella.triandra</td>
<td align="right">3.173789</td>
<td align="right">1.101564</td>
<td align="right">3.206655</td>
<td align="right">2.494003</td>
</tr>
<tr class="even">
<td align="left">Gustavia.superba</td>
<td align="right">3.001352</td>
<td align="right">1.079533</td>
<td align="right">3.121450</td>
<td align="right">2.400778</td>
</tr>
<tr class="odd">
<td align="left">Virola.sebifera</td>
<td align="right">2.875519</td>
<td align="right">1.035470</td>
<td align="right">2.984368</td>
<td align="right">2.298452</td>
</tr>
<tr class="even">
<td align="left">Protium.tenuifolium</td>
<td align="right">1.775644</td>
<td align="right">1.101564</td>
<td align="right">1.717914</td>
<td align="right">1.531707</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="clases-dimetricas" class="section level2">
<h2>Clases dimétricas:</h2>
<ul>
<li>Para determinar las clases dimétricas, es necesario conocer el rango en el cual varia el DAP de los árboles, así podemos determinar el número de clases con la cual deseamos trabajar.</li>
</ul>
<pre class="r"><code>data %&gt;% summarise(Dap_min = min(dap),
                   Dap_max = max(dap),
                   Ramgo = Dap_max - Dap_min) </code></pre>
<table>
<thead>
<tr class="header">
<th align="right">Dap_min</th>
<th align="right">Dap_max</th>
<th align="right">Ramgo</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">10.00023</td>
<td align="right">59.9991</td>
<td align="right">49.99887</td>
</tr>
</tbody>
</table>
<ul>
<li>Se puede ver que el DAP varía entre 10 y 59.7. El rango de los datos es 50, podemos determinar por ejemplo cinco clases dimétricas cada 10 cm:</li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left">Intervalo</th>
<th align="left">Clase</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">10 - 20</td>
<td align="left">Clase 1</td>
</tr>
<tr class="even">
<td align="left">20 - 30</td>
<td align="left">Clase 2</td>
</tr>
<tr class="odd">
<td align="left">30 - 40</td>
<td align="left">Clase 3</td>
</tr>
<tr class="even">
<td align="left">40 - 50</td>
<td align="left">Clase 4</td>
</tr>
<tr class="odd">
<td align="left">50 - 60</td>
<td align="left">Clase 5</td>
</tr>
<tr class="even">
<td align="left">…</td>
<td align="left">Clase …</td>
</tr>
</tbody>
</table>
<ul>
<li>Las siguientes líneas crean una nueva columna en el dataframe (base de datos), asignando cada una de las observaciones a una de las clases dimétricas:</li>
</ul>
<pre class="r"><code># Creamos un nuevo dataframe con la columna diam_class y la asignamos al objeto clase_diametrica.
clase_diametrica &lt;- data %&gt;% 
  mutate(
    diam_class = case_when(
      dap &gt;= 10 &amp; dap &lt; 20 ~ &quot;Clase_1&quot;,
      dap &gt;= 20 &amp; dap &lt; 30 ~ &quot;Clase_2&quot;,
      dap &gt;= 30 &amp; dap &lt; 40 ~ &quot;Clase_3&quot;,
      dap &gt;= 40 &amp; dap &lt; 50 ~ &quot;Clase_4&quot;,
      dap &gt;= 50 &amp; dap &lt; 60 ~ &quot;Clase_5&quot;,
      is.na(dap) ~ &quot;sin DAP&quot; ))
</code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Sub parcela</th>
<th align="left">Especie</th>
<th align="right">DAP</th>
<th align="right">Area basal</th>
<th align="left">Clase diametrica</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alchornea.costaricensis</td>
<td align="right">15.93544</td>
<td align="right">454.8143</td>
<td align="left">Clase_1</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alchornea.costaricensis</td>
<td align="right">10.58561</td>
<td align="right">1994.3443</td>
<td align="left">Clase_1</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">46.93351</td>
<td align="right">1552.6553</td>
<td align="left">Clase_4</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">58.68267</td>
<td align="right">1022.7831</td>
<td align="left">Clase_5</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">53.60771</td>
<td align="right">2009.3311</td>
<td align="left">Clase_5</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">55.29882</td>
<td align="right">1650.4052</td>
<td align="left">Clase_5</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">36.71813</td>
<td align="right">492.2388</td>
<td align="left">Clase_3</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">47.22068</td>
<td align="right">1247.1045</td>
<td align="left">Clase_4</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">31.01860</td>
<td align="right">1095.4845</td>
<td align="left">Clase_3</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">Alseis.blackiana</td>
<td align="right">16.20021</td>
<td align="right">746.6729</td>
<td align="left">Clase_1</td>
</tr>
</tbody>
</table>
<ul>
<li><p>La primera clase <em>(Clase 1)</em> dimétricas está conformada por todos los arboles con un DAP entre 10 y 20 cm, el código incluye en este grupo todos los arboles con un DAP mayor igual a 10 y menor a 20. (<code>dap &gt;= 10 &amp; dap &lt; 20 ~ "Clase_1"</code>).</p></li>
<li><p>El siguiente código genera una tabla resumen con los valores mínimos, máximos, rango y número de individuos por cada clase dimétricas.</p></li>
</ul>
<pre class="r"><code>clase_diametrica %&gt;%  
group_by(diam_class) %&gt;% 
  summarise(min = min(dap),
            max = max(dap), 
            rango =max- min,
            n = n()) </code></pre>
<table>
<thead>
<tr class="header">
<th align="left">Clase diametrica</th>
<th align="right">Min_DAP</th>
<th align="right">Max_DAP</th>
<th align="right">Rango</th>
<th align="right">N_individuos</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Clase_1</td>
<td align="right">10.00023</td>
<td align="right">19.99754</td>
<td align="right">9.997310</td>
<td align="right">4261</td>
</tr>
<tr class="even">
<td align="left">Clase_2</td>
<td align="right">20.00121</td>
<td align="right">29.99658</td>
<td align="right">9.995369</td>
<td align="right">4269</td>
</tr>
<tr class="odd">
<td align="left">Clase_3</td>
<td align="right">30.00116</td>
<td align="right">39.99602</td>
<td align="right">9.994864</td>
<td align="right">4260</td>
</tr>
<tr class="even">
<td align="left">Clase_4</td>
<td align="right">40.00089</td>
<td align="right">49.99788</td>
<td align="right">9.996992</td>
<td align="right">4373</td>
</tr>
<tr class="odd">
<td align="left">Clase_5</td>
<td align="right">50.00297</td>
<td align="right">59.99910</td>
<td align="right">9.996125</td>
<td align="right">4294</td>
</tr>
</tbody>
</table>
<ul>
<li>La representación gráfica de las clases dimétricas la obtendremos mediante las siguientes líneas de código:</li>
</ul>
<pre class="r"><code>clase_diametrica %&gt;%
  group_by(diam_class) %&gt;% 
  summarise(min = min(dap),
            max = max(dap), 
            rango =max- min,
            n = n()) %&gt;% 
  ggplot(aes(diam_class, n)) +
  geom_point(size = 5, color = &quot;red&quot;)+
  geom_line(aes(c(1:5), n), linetype = &quot;dashed&quot;)+
  theme_bw()+
  scale_y_continuous(breaks=seq(75,150,5))+
  theme(axis.text.x  = element_text(angle=0, vjust=0.5, 
                                    size=11, face = &quot;bold&quot;),
        axis.text.y.left  = element_text(angle = 0, vjust = .5,
                                         size = 11, face = &quot;bold&quot;), 
        axis.title.y = element_text(size = 14),
        axis.title.x = element_text(size = 14),
        plot.title = element_text(hjust = .5, face = &quot;bold&quot;))+
  labs(x = &quot;Clase Diametrica&quot;, 
       y = &quot;Número de individuos&quot;,
       title = &quot;Estructura Dimétrica&quot;)</code></pre>
<p><img src="/post/2018-10-05-indice_valor_importancia_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
</div>
