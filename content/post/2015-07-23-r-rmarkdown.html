---
title: "Intervalos de Confianza"
author: "Paul Efren Santos Andrade"
date: 2018-08-23
categories: ["R"]
tags: ["R Markdown", "plot"]
---



<p>Supongamos que estamos buscando conocer cual es el promedio de la densidad de madera de todas las especies arboreas conocidas para la ciencia. Para este ejemplo generaremos datos referentes a la dencidad de madera para las especies arboreas tomaremos informacion de los trabajos de Zanne, A.E et,al. 2009 y Beech, E. et,al. 2017.</p>
<pre class="r"><code>set.seed(2017-12-17)
#Numero de especies arboreas conocidas  aprox. 60 000. Beech, E. #et,al. 2017.
#Promedio y desviaci?n estandar de la densidad de madera, 0.6134 y #0.1759 respectivamente. Zanne, A.E et,al. 2009
poblacion &lt;- rnorm(60000,0.6134,0.1759)</code></pre>
<p>Lo que estamos buscando es estimar el promedio de la densidad de madera , para este ejemplo es “0.6130953”.</p>
<p>Normalmente nosotros no podemos medir todos los elementos de una poblaci?n, por lo cual recurrimos a muestras de esta.</p>
<p>Tomamemos como referencia ua muestra de 100 especies.</p>
<pre class="r"><code>primera_muestra &lt;- sample(poblacion, 100)</code></pre>
<p>Ahora con esta muestra podemos construir el <strong>intervalo_de_confianza</strong> con un 95% de confianza para el promedio de la densidad de madera:</p>
<pre class="r"><code># limite inferior &quot;li&quot;

li &lt;- mean(primera_muestra) - 1.96 * (sd(primera_muestra)/sqrt(length(primera_muestra)))
(li)
## [1] 0.581354</code></pre>
<pre class="r"><code>
# limite superior &quot;ls&quot;
 
ls &lt;- mean(primera_muestra) + 1.96 * (sd(primera_muestra)/sqrt(length(primera_muestra)))
(ls)
## [1] 0.6549992</code></pre>
<p>Como podemos interpretar un intervalo de confianza?
Si tomamos varias muestras de nuestra poblaci?n, el valor real del promedio de esta deberia ser contenido por el intervalo de confiaza de cada una de las muestras.</p>
<p>Supongamos que hasta el momento se han generado 1000 estudios enfocados en la evaluacion de la densidad de madera:</p>
<pre class="r"><code>#Cada columna en la matris *estudios* alberga la informacio #generada por cada uno de los estudios.

estudios&lt;- replicate(1000, sample(poblacion, 100))

limite_inferior&lt;- apply(estudios, 2, function(row){
  mean(row) - 1.96 * (sd(row)/sqrt(length(row)))
})

limite_superior &lt;- apply(estudios, 2, function(row){
  mean(row) + 1.96 * (sd(row)/sqrt(length(row)))
})

promedio_real &lt;- mean(poblacion)
promedio_real
## [1] 0.6135061</code></pre>
<p>Revisemos algunos datos:
Cuantos intervalos de confianza contienen el valor real del
promedio de la densidad de madera?.</p>
<pre class="r"><code>mean(promedio_real &gt; limite_inferior &amp; promedio_real&lt; limite_superior)*100
## [1] 95.1</code></pre>
<p>En el 95.1 % de los 1000 estudios los intervalos de confianza contienen el promedio de la densidad de madera.</p>
<p>Visualizemos graficamente estos nuestros resultados:</p>
<pre class="r"><code># Concideremos unicamente los resultados de los primeros cien 
# estudios generados.

par(mar=c(2,2,0,0)+.5, mgp=c(1.6,.4,0), tcl=-.2, 
    las=1, cex.axis=.9) 

plot(0, 0, xlim = c(1, 100), ylim = c(min(limite_inferior), max(limite_superior)),
     xlab = &quot;Numero de estudios&quot;, ylab = &quot;Intervalo de Confianza&quot;, bty = &quot;n&quot;,
     col = &quot;white&quot;,axes = FALSE)
rect(par(&quot;usr&quot;)[1], par(&quot;usr&quot;)[3], par(&quot;usr&quot;)[2], 
     par(&quot;usr&quot;)[4], col=gray(.9,.9), border=&#39;white&#39;)
grid(lty=1, col=&#39;white&#39;)
for(i in 1:100){
  segments(i, limite_inferior[i], i, limite_superior[i], lwd = 2,col=&quot;blue&quot;)
}
abline(h = promedio_real, col = 1, lwd = 2,lty=2)
legend(70, .55, legend = &quot;Promedio real&quot;, col = 1, lty = 1, bty = &quot;n&quot;)
axis(1,lwd=2,las=1)
axis(2,las=2,lwd=2)</code></pre>
<p><img src="/post/2015-07-23-r-rmarkdown_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div id="referencias" class="section level1">
<h1>Referencias:</h1>
<p>Basado en <strong>A Short Intro to Confidence Intervals</strong> por <a href="http://seankross.com/">Sean Kross</a>.</p>
<p>Zanne, A.E., Lopez-Gonzalez, G., Coomes, D.A., Ilic, J., Jansen, S., Lewis, S.L., Miller, R.B., Swenson, N.G., Wiemann, M.C., and Chave, J. 2009. <a href="http://hdl.handle.net/10255/dryad.235"><strong>Global wood density database. Dryad. Identifier</strong></a>.</p>
<p>E. Beech, M. Rivers, S. Oldfield &amp; P.P. Smith (2017): <a href="https://www.researchgate.net/publication/315596971_GlobalTreeSearch_The_first_complete_global_database_of_tree_species_and_country_distributions"><strong>GlobalTreeSearch: The first complete global database of tree species and country distributions.</strong></a></p>
</div>
